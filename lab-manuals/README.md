# Lab Manual Toolkit

A complete toolkit for generating professional PDF manuals from Markdown using Pandoc and XeLaTeX. Produces print-ready A4 documents with a full-bleed cover page, automatic table of contents, numbered sections, syntax-highlighted code blocks, and styled callout boxes.

## Prerequisites

### Software

| Package | Purpose |
|---------|---------|
| `pandoc` (>= 2.19) | Markdown-to-LaTeX conversion |
| `texlive-xetex` | XeLaTeX PDF engine |
| `texlive-latex-extra` | Extra LaTeX packages (tcolorbox, fancyhdr, titlesec, etc.) |
| `texlive-fonts-extra` | Additional font packages |
| `texlive-fonts-recommended` | Standard font packages (pzdr, etc.) |

### Fonts

The template uses the [Google Noto](https://fonts.google.com/noto) font family. Install these fonts system-wide:

- **Noto Sans** (Regular, Bold, Italic, Bold Italic) -- body text
- **Noto Sans Mono** (Regular, Bold) -- code listings
- **DejaVu Sans** -- fallback for Unicode symbols (arrows, box-drawing characters)

On Debian/Ubuntu:

```bash
sudo apt install fonts-noto fonts-dejavu-core \
  pandoc texlive-xetex texlive-latex-extra \
  texlive-fonts-extra texlive-fonts-recommended
```

On Fedora:

```bash
sudo dnf install google-noto-sans-fonts google-noto-sans-mono-fonts dejavu-sans-fonts \
  pandoc texlive-xetex texlive-collection-latexextra \
  texlive-collection-fontsextra texlive-collection-fontsrecommended
```

## Quick Start

1. Copy this toolkit into your project
2. Write your manual as a Markdown file in `src/`
3. Add a target in the Makefile
4. Run `make`

```bash
# Build all manuals
make all

# Build a single manual
make MY_MANUAL

# Clean generated PDFs
make clean
```

## Markdown Source Format

Each manual is a single Markdown file with a YAML front matter block. The front matter controls the cover page and headers/footers.

```yaml
---
title: "Your Manual Title"
subtitle: "A Descriptive Subtitle"
author: "Your Name or Organization"
date: "2026-01-15"
version: "1.0"
manual-id: "REF-001"
---
```

### Front Matter Fields

| Field | Required | Description |
|-------|----------|-------------|
| `title` | Yes | Main title on cover page and PDF metadata |
| `subtitle` | No | Subtitle below the title on cover page |
| `author` | No | Author line on cover page (defaults to "Your Lab Name") |
| `date` | Yes | Revision date shown in cover and footer |
| `version` | No | Version number on cover page (defaults to "1.0") |
| `manual-id` | No | Identifier shown above the title on cover page |

### Structure

Use standard Markdown headings. Top-level `#` headings become chapters, `##` become sections, and so on down to `####`.

```markdown
# Chapter Title

## Section

### Subsection

#### Sub-subsection
```

### Callout Boxes

The included Lua filter converts specially-formatted blockquotes into styled callout boxes in the PDF. Four types are supported:

```markdown
> **See Also:** Manual 2, Section 3.1 -- Network Configuration

> **STATUS: PLANNED** -- This feature is not yet implemented.

> **Warning:** Changing this setting requires a full restart.

> **Note:** This value is case-sensitive.
```

These render as colored boxes:

- **See Also** -- green box for cross-references
- **STATUS: PLANNED** -- orange box for future/unimplemented features
- **Warning** -- red box for dangerous operations
- **Note** -- blue box for supplementary information

### Tables

Standard Markdown pipe tables are supported and render with professional formatting:

```markdown
| Host | IP Address | Role |
|------|------------|------|
| server1 | 10.0.1.10 | Application server |
| server2 | 10.0.1.20 | Database server |
```

Tables automatically use a smaller font size and tighter padding to fit wide content on A4 pages.

### Code Blocks

Fenced code blocks with language hints get syntax highlighting:

````markdown
```bash
#!/bin/bash
systemctl restart nginx
```
````

## Customization

### Colors

Edit the color definitions in `templates/lab-manual.latex` to match your branding:

```latex
\definecolor{korblue}{HTML}{1a5276}     % Headings, links
\definecolor{korgray}{HTML}{566573}     % Headers, footers
\definecolor{coverblue}{HTML}{0d2137}   % Cover page background
```

### Header/Footer Text

The right header displays a fixed organization name. Change it in the template:

```latex
\fancyhead[R]{\small\textcolor{korgray}{Your Organization}}
```

The footer shows page numbers (center) and revision date (right). The left header shows the current chapter name automatically.

### Cover Page

The cover page is generated by TikZ in the template. Modify the `titlepage` environment to change layout, add a logo, or adjust spacing.

### Fonts

To use different fonts, update the `\setmainfont`, `\setsansfont`, and `\setmonofont` declarations. Any font installed system-wide and supported by XeLaTeX can be used.

## Directory Structure

```
lab-manuals/
  Makefile                    # Build system
  templates/
    lab-manual.latex          # Pandoc XeLaTeX template
  filters/
    callouts.lua              # Pandoc Lua filter for callout boxes
  src/                        # Your Markdown source files
    my-first-manual.md
    my-second-manual.md
  out/                        # Generated PDFs (created by make)
  examples/                   # Skeleton files to get started
    example-overview.md
    example-network.md
    example-services.md
```

## Adding a New Manual

1. Create a Markdown file in `src/` with YAML front matter
2. Add a target block in the Makefile (follow the pattern in the comments)
3. Run `make YOUR_TARGET`

See the `examples/` directory for skeleton files demonstrating the expected structure, callout usage, and section organization.

## Troubleshooting

| Problem | Solution |
|---------|----------|
| Missing font errors | Install the Noto Sans font family system-wide |
| `! LaTeX Error: File 'tcolorbox.sty' not found` | Install `texlive-latex-extra` |
| `! Package fontspec Error: The font "Noto Sans" cannot be found` | Ensure fonts are installed; run `fc-cache -fv` |
| Tables overflow page width | The template already uses footnotesize for tables; shorten cell content or split into multiple tables |
| Unicode symbols show as boxes | Install DejaVu Sans (`fonts-dejavu-core` on Debian) |
| `! LaTeX Error: File 'pzdr.tfm' not found` | Install `texlive-fonts-recommended` |
